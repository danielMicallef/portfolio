---
import Layout from './Layout.astro';
import { t } from '../utils/i18n';

export interface Props {
  frontmatter: {
    title: string;
    lead?: string;
    date: string;
    tags?: string[];
    draft?: boolean;
  };
}

const { frontmatter } = Astro.props;
const lang = Astro.currentLocale;

const pageTitle = frontmatter.title + " | " + t('site.title', lang);
const pageDescription = frontmatter.lead || frontmatter.title;

// Format the date
const formattedDate = new Date(frontmatter.date).toLocaleDateString(lang === 'de' ? 'de-DE' : 'en-US', {
  year: 'numeric',
  month: 'long',
  day: 'numeric'
});
---

<Layout title={pageTitle} description={pageDescription} lang={lang}>
  <article class="py-16 md:py-24">
    <div class="max-w-4xl mx-auto px-6">
      <!-- Back to Blog Navigation -->
      <div class="mb-8">
        <a
          href="/blog/"
          class="inline-flex items-center text-secondary/60 dark:text-white/60 hover:text-primary dark:hover:text-primary-light transition-colors"
        >
          <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
          </svg>
          {t('blog.backToBlog', lang) || 'Back to Blog'}
        </a>
      </div>

      <!-- Article Header -->
      <header class="mb-12">
        <h1 class="font-heading text-h1 text-secondary dark:text-white mb-4">
          {frontmatter.title}
        </h1>

        {frontmatter.lead && (
          <p class="text-xl text-secondary/80 dark:text-white/80 mb-6">
            {frontmatter.lead}
          </p>
        )}

        <div class="flex flex-wrap items-center gap-4 text-sm text-secondary/60 dark:text-white/60">
          <time datetime={frontmatter.date}>
            {formattedDate}
          </time>

          {frontmatter.tags && frontmatter.tags.length > 0 && (
            <div class="flex flex-wrap gap-2">
              {frontmatter.tags.map(tag => (
                <span class="px-3 py-1 bg-primary/10 dark:bg-primary/20 text-primary dark:text-primary-light rounded-full text-xs">
                  {tag}
                </span>
              ))}
            </div>
          )}
        </div>
      </header>

      <!-- Article Content with Tailwind Typography -->
      <div class="prose prose-lg dark:prose-invert max-w-none
        prose-headings:font-heading prose-headings:text-secondary dark:prose-headings:text-white
        prose-p:text-secondary/90 dark:prose-p:text-white/90
        prose-a:text-primary dark:prose-a:text-primary-light prose-a:no-underline hover:prose-a:underline
        prose-strong:text-secondary dark:prose-strong:text-white
        prose-code:text-primary dark:prose-code:text-primary-light prose-code:bg-neutral-bg dark:prose-code:bg-neutral-dark/50 prose-code:px-1 prose-code:py-0.5 prose-code:rounded prose-code:before:content-[''] prose-code:after:content-['']
        prose-pre:bg-neutral-bg dark:prose-pre:bg-neutral-dark/50 prose-pre:border prose-pre:border-secondary/10 dark:prose-pre:border-white/10 prose-pre:text-inherit
        [&_pre_code]:!text-inherit [&_pre_code]:!bg-transparent [&_pre_code]:!p-0
        prose-blockquote:border-l-primary dark:prose-blockquote:border-l-primary-light prose-blockquote:text-secondary/80 dark:prose-blockquote:text-white/80
        prose-ul:text-secondary/90 dark:prose-ul:text-white/90
        prose-ol:text-secondary/90 dark:prose-ol:text-white/90
        prose-li:text-secondary/90 dark:prose-li:text-white/90
        prose-img:rounded-lg prose-img:shadow-lg
        prose-hr:border-secondary/20 dark:prose-hr:border-white/20
        prose-table:text-secondary/90 dark:prose-table:text-white/90
        prose-th:bg-neutral-bg dark:prose-th:bg-neutral-dark/50
        prose-td:border-secondary/10 dark:prose-td:border-white/10
      ">
        <slot />
      </div>

      <!-- Back to Blog Link -->
      <div class="mt-12 pt-8 border-t border-secondary/10 dark:border-white/10">
        <a
          href="/blog/"
          class="inline-flex items-center text-primary dark:text-primary-light hover:underline font-medium"
        >
          <svg class="w-4 h-4 mr-2 rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
          </svg>
          {t('blog.backToBlog', lang) || 'Back to Blog'}
        </a>
      </div>
    </div>
  </article>
</Layout>
